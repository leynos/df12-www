<!doctype html>
<html lang="en" data-theme="df12">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <link href="assets/site.css" rel="stylesheet" />
  <title>df12 Productions — Step definitions | rstest-bdd</title>
  <style>
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #49483e }
.codehilite { background: #272822; color: #F8F8F2 }
.codehilite .c { color: #959077 } /* Comment */
.codehilite .err { color: #ED007E; background-color: #1E0010 } /* Error */
.codehilite .esc { color: #F8F8F2 } /* Escape */
.codehilite .g { color: #F8F8F2 } /* Generic */
.codehilite .k { color: #66D9EF } /* Keyword */
.codehilite .l { color: #AE81FF } /* Literal */
.codehilite .n { color: #F8F8F2 } /* Name */
.codehilite .o { color: #FF4689 } /* Operator */
.codehilite .x { color: #F8F8F2 } /* Other */
.codehilite .p { color: #F8F8F2 } /* Punctuation */
.codehilite .ch { color: #959077 } /* Comment.Hashbang */
.codehilite .cm { color: #959077 } /* Comment.Multiline */
.codehilite .cp { color: #959077 } /* Comment.Preproc */
.codehilite .cpf { color: #959077 } /* Comment.PreprocFile */
.codehilite .c1 { color: #959077 } /* Comment.Single */
.codehilite .cs { color: #959077 } /* Comment.Special */
.codehilite .gd { color: #FF4689 } /* Generic.Deleted */
.codehilite .ge { color: #F8F8F2; font-style: italic } /* Generic.Emph */
.codehilite .ges { color: #F8F8F2; font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.codehilite .gr { color: #F8F8F2 } /* Generic.Error */
.codehilite .gh { color: #F8F8F2 } /* Generic.Heading */
.codehilite .gi { color: #A6E22E } /* Generic.Inserted */
.codehilite .go { color: #66D9EF } /* Generic.Output */
.codehilite .gp { color: #FF4689; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { color: #F8F8F2; font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #959077 } /* Generic.Subheading */
.codehilite .gt { color: #F8F8F2 } /* Generic.Traceback */
.codehilite .kc { color: #66D9EF } /* Keyword.Constant */
.codehilite .kd { color: #66D9EF } /* Keyword.Declaration */
.codehilite .kn { color: #FF4689 } /* Keyword.Namespace */
.codehilite .kp { color: #66D9EF } /* Keyword.Pseudo */
.codehilite .kr { color: #66D9EF } /* Keyword.Reserved */
.codehilite .kt { color: #66D9EF } /* Keyword.Type */
.codehilite .ld { color: #E6DB74 } /* Literal.Date */
.codehilite .m { color: #AE81FF } /* Literal.Number */
.codehilite .s { color: #E6DB74 } /* Literal.String */
.codehilite .na { color: #A6E22E } /* Name.Attribute */
.codehilite .nb { color: #F8F8F2 } /* Name.Builtin */
.codehilite .nc { color: #A6E22E } /* Name.Class */
.codehilite .no { color: #66D9EF } /* Name.Constant */
.codehilite .nd { color: #A6E22E } /* Name.Decorator */
.codehilite .ni { color: #F8F8F2 } /* Name.Entity */
.codehilite .ne { color: #A6E22E } /* Name.Exception */
.codehilite .nf { color: #A6E22E } /* Name.Function */
.codehilite .nl { color: #F8F8F2 } /* Name.Label */
.codehilite .nn { color: #F8F8F2 } /* Name.Namespace */
.codehilite .nx { color: #A6E22E } /* Name.Other */
.codehilite .py { color: #F8F8F2 } /* Name.Property */
.codehilite .nt { color: #FF4689 } /* Name.Tag */
.codehilite .nv { color: #F8F8F2 } /* Name.Variable */
.codehilite .ow { color: #FF4689 } /* Operator.Word */
.codehilite .pm { color: #F8F8F2 } /* Punctuation.Marker */
.codehilite .w { color: #F8F8F2 } /* Text.Whitespace */
.codehilite .mb { color: #AE81FF } /* Literal.Number.Bin */
.codehilite .mf { color: #AE81FF } /* Literal.Number.Float */
.codehilite .mh { color: #AE81FF } /* Literal.Number.Hex */
.codehilite .mi { color: #AE81FF } /* Literal.Number.Integer */
.codehilite .mo { color: #AE81FF } /* Literal.Number.Oct */
.codehilite .sa { color: #E6DB74 } /* Literal.String.Affix */
.codehilite .sb { color: #E6DB74 } /* Literal.String.Backtick */
.codehilite .sc { color: #E6DB74 } /* Literal.String.Char */
.codehilite .dl { color: #E6DB74 } /* Literal.String.Delimiter */
.codehilite .sd { color: #E6DB74 } /* Literal.String.Doc */
.codehilite .s2 { color: #E6DB74 } /* Literal.String.Double */
.codehilite .se { color: #AE81FF } /* Literal.String.Escape */
.codehilite .sh { color: #E6DB74 } /* Literal.String.Heredoc */
.codehilite .si { color: #E6DB74 } /* Literal.String.Interpol */
.codehilite .sx { color: #E6DB74 } /* Literal.String.Other */
.codehilite .sr { color: #E6DB74 } /* Literal.String.Regex */
.codehilite .s1 { color: #E6DB74 } /* Literal.String.Single */
.codehilite .ss { color: #E6DB74 } /* Literal.String.Symbol */
.codehilite .bp { color: #F8F8F2 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #A6E22E } /* Name.Function.Magic */
.codehilite .vc { color: #F8F8F2 } /* Name.Variable.Class */
.codehilite .vg { color: #F8F8F2 } /* Name.Variable.Global */
.codehilite .vi { color: #F8F8F2 } /* Name.Variable.Instance */
.codehilite .vm { color: #F8F8F2 } /* Name.Variable.Magic */
.codehilite .il { color: #AE81FF } /* Literal.Number.Integer.Long */

    .codehilite {
      background-color: var(--color-neutral);
      border-radius: 0.75rem;
      padding: 1.25rem;
      color: var(--color-neutral-content);
      font-family: "IBM Plex Mono", monospace;
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.45);
      overflow: hidden;
    }

    .codehilite pre {
      margin: 0;
      background: transparent;
      font-family: inherit;
      font-size: inherit;
      border: none;
      padding: 0;
      box-shadow: none;
      overflow-x: auto;
    }

    .codehilite__chrome {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.7rem;
      text-transform: uppercase;
      color: rgba(255, 255, 255, 0.7);
      gap: 1rem;
    }

    .codehilite__language {
      white-space: nowrap;
    }

    .codehilite__copy {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      border-radius: 999px;
      color: var(--color-neutral-content);
      font-family: inherit;
      font-size: 0.65rem;
      text-transform: uppercase;
      padding: 0.2rem 0.9rem;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
    }

    .codehilite__copy:hover,
    .codehilite__copy:focus-visible {
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.6);
    }

    .codehilite__copy[data-state="copied"] {
      background: var(--color-accent);
      color: var(--color-accent-content);
      border-color: transparent;
    }

    .codehilite__copy-icon {
      width: 0.85rem;
      height: 0.85rem;
      display: block;
    }

    .svg-inline--fa {
      display: inline;
    }
  </style>
</head>
<body class="doc-page">
  <a href="#main-content" class="skip-link sr-only-focusable">Skip to content</a>

  <header id="site-header" class="site-header">
    <div class="layout-shell layout-shell--docs site-header__inner">
      <a href="index.html" class="site-header__brand group">
        <span class="site-header__logo-mark">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <rect x="12" width="16.9706" height="16.9706" transform="rotate(45 12 0)" />
          </svg>
        </span>
        df12
      </a>
      <nav aria-label="Primary navigation" class="site-header__nav">
        <a href="index.html#systems" class="nav-link hit-target">Tools</a>
        <a href="index.html#worlds" class="nav-link hit-target" data-variant="accent">Creative</a>
        <a href="docs.html" class="nav-link hit-target" data-variant="neutral" aria-current="page">Docs</a>
        <a href="about.html" class="nav-link hit-target" data-variant="neutral">About</a>
      </nav>
      <div class="md:hidden">
        <details class="dropdown dropdown-end">
          <summary class="btn btn-ghost btn-sm site-header__menu-button">Menu</summary>
          <ul class="menu dropdown-content menu-sm z-[1] mt-2 w-44 rounded-box bg-base-100 p-2 shadow">
            <li><a href="index.html#systems" class="nav-link hit-target site-header__mobile-link">Tools</a></li>
            <li><a href="index.html#worlds" class="nav-link hit-target site-header__mobile-link" data-variant="accent">Creative</a></li>
            <li><a href="docs.html" class="nav-link hit-target site-header__mobile-link" data-variant="neutral" aria-current="page">Docs</a></li>
            <li><a href="about.html" class="nav-link hit-target site-header__mobile-link" data-variant="neutral">About</a></li>
          </ul>
        </details>
      </div>
    </div>
  </header>

  <main id="main-content" class="site-main site-main--doc">
    <div class="layout-shell layout-shell--docs doc-grid">
      <aside class="doc-sidebar" aria-label="Documentation navigation">
        <div class="doc-sidebar__panel">
          <a href="docs.html" class="doc-sidebar__back">
            <iconify-icon icon="carbon:arrow-left" class="h-4 w-4" aria-hidden="true"></iconify-icon>
            Back to docs
          </a>
          <div>
            <p class="doc-sidebar__eyebrow">rstest-bdd</p>
            <p class="doc-sidebar__body">Behavior-driven testing macros layered on top of `rstest`. Narrative clarity without the ceremony.
</p>
          </div>
          <div class="doc-sidebar__groups">
              <div class="doc-nav-group" aria-label="Introduction">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-introduction.html">Introduction</a>
                </h3>
              </div>
              <div class="doc-nav-group" aria-label="Toolchain requirements">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-toolchain-requirements.html">Toolchain requirements</a>
                </h3>
              </div>
              <div class="doc-nav-group" aria-label="The three amigos">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-the-three-amigos.html">The three amigos</a>
                </h3>
              </div>
              <div class="doc-nav-group" aria-label="Gherkin feature files">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-gherkin-feature-files.html">Gherkin feature files</a>
                </h3>
                  <ul class="doc-nav__list" role="list">
                      <li>
                        <a href="docs-rstest-bdd-gherkin-feature-files.html#gherkin-feature-files-example-feature-file"
                           class="doc-nav__link "
>
                          <span>Example feature file</span>
                        </a>
                      </li>
                      <li>
                        <a href="docs-rstest-bdd-gherkin-feature-files.html#gherkin-feature-files-internationalised-scenarios"
                           class="doc-nav__link "
>
                          <span>Internationalised scenarios</span>
                        </a>
                      </li>
                  </ul>
              </div>
              <div class="doc-nav-group" aria-label="Step definitions">
                <h3 class="doc-nav-group__title is-active" aria-current="page">
                  <a href="docs-rstest-bdd-step-definitions.html">Step definitions</a>
                </h3>
                  <ul class="doc-nav__list" role="list">
                      <li>
                        <a href="docs-rstest-bdd-step-definitions.html#step-definitions-fixtures-and-implicit-injection"
                           class="doc-nav__link "
>
                          <span>Fixtures and implicit injection</span>
                        </a>
                      </li>
                      <li>
                        <a href="docs-rstest-bdd-step-definitions.html#step-definitions-step-return-values"
                           class="doc-nav__link "
>
                          <span>Step return values</span>
                        </a>
                      </li>
                      <li>
                        <a href="docs-rstest-bdd-step-definitions.html#step-definitions-struct-based-step-arguments"
                           class="doc-nav__link "
>
                          <span>Struct-based step arguments</span>
                        </a>
                      </li>
                      <li>
                        <a href="docs-rstest-bdd-step-definitions.html#step-definitions-scenario-state-slots"
                           class="doc-nav__link "
>
                          <span>Scenario state slots</span>
                        </a>
                      </li>
                      <li>
                        <a href="docs-rstest-bdd-step-definitions.html#step-definitions-implicit-fixture-injection"
                           class="doc-nav__link "
>
                          <span>Implicit fixture injection</span>
                        </a>
                      </li>
                      <li>
                        <a href="docs-rstest-bdd-step-definitions.html#step-definitions-inferred-step-patterns"
                           class="doc-nav__link "
>
                          <span>Inferred step patterns</span>
                        </a>
                      </li>
                  </ul>
              </div>
              <div class="doc-nav-group" aria-label="Binding tests to scenarios">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-binding-tests-to-scenarios.html">Binding tests to scenarios</a>
                </h3>
                  <ul class="doc-nav__list" role="list">
                      <li>
                        <a href="docs-rstest-bdd-binding-tests-to-scenarios.html#binding-tests-to-scenarios-skipping-scenarios"
                           class="doc-nav__link "
>
                          <span>Skipping scenarios</span>
                        </a>
                      </li>
                  </ul>
              </div>
              <div class="doc-nav-group" aria-label="Autodiscovering scenarios">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-autodiscovering-scenarios.html">Autodiscovering scenarios</a>
                </h3>
              </div>
              <div class="doc-nav-group" aria-label="Running and maintaining tests">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-running-and-maintaining-tests.html">Running and maintaining tests</a>
                </h3>
              </div>
              <div class="doc-nav-group" aria-label="Data tables and Docstrings">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-data-tables-and-docstrings.html">Data tables and Docstrings</a>
                </h3>
                  <ul class="doc-nav__list" role="list">
                      <li>
                        <a href="docs-rstest-bdd-data-tables-and-docstrings.html#data-tables-and-docstrings-debugging-data-table-errors"
                           class="doc-nav__link "
>
                          <span>Debugging data table errors</span>
                        </a>
                      </li>
                  </ul>
              </div>
              <div class="doc-nav-group" aria-label="Limitations and roadmap">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-limitations-and-roadmap.html">Limitations and roadmap</a>
                </h3>
              </div>
              <div class="doc-nav-group" aria-label="Assertion macros">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-assertion-macros.html">Assertion macros</a>
                </h3>
              </div>
              <div class="doc-nav-group" aria-label="Internationalization and localization">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-internationalization-and-localization.html">Internationalization and localization</a>
                </h3>
                  <ul class="doc-nav__list" role="list">
                      <li>
                        <a href="docs-rstest-bdd-internationalization-and-localization.html#internationalization-and-localization-writing-feature-files-in-other-languages"
                           class="doc-nav__link "
>
                          <span>Writing feature files in other languages</span>
                        </a>
                      </li>
                      <li>
                        <a href="docs-rstest-bdd-internationalization-and-localization.html#internationalization-and-localization-localizing-runtime-diagnostics"
                           class="doc-nav__link "
>
                          <span>Localizing runtime diagnostics</span>
                        </a>
                      </li>
                  </ul>
              </div>
              <div class="doc-nav-group" aria-label="Diagnostic tooling">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-diagnostic-tooling.html">Diagnostic tooling</a>
                </h3>
                  <ul class="doc-nav__list" role="list">
                      <li>
                        <a href="docs-rstest-bdd-diagnostic-tooling.html#diagnostic-tooling-scenario-report-writers"
                           class="doc-nav__link "
>
                          <span>Scenario report writers</span>
                        </a>
                      </li>
                  </ul>
              </div>
              <div class="doc-nav-group" aria-label="Summary">
                <h3 class="doc-nav-group__title " >
                  <a href="docs-rstest-bdd-summary.html">Summary</a>
                </h3>
              </div>
          </div>
          <div>
            <p class="doc-sidebar__section-label">Source</p>
            <a class="inline-flex items-center gap-2 font-semibold text-primary" href="https://raw.githubusercontent.com/leynos/rstest-bdd/refs/tags/v0.1.0/docs/users-guide.md" target="_blank" rel="noopener">
              View markdown
              <iconify-icon icon="carbon:arrow-up-right" aria-hidden="true"></iconify-icon>
            </a>
            <p class="mt-1 text-xs text-base-content/60">Source material</p>
          </div>
        </div>
      </aside>

      <section class="space-y-6" id="step-definitions">
        <nav class="doc-mobile-nav" aria-labelledby="mobile-sections-label">
          <p id="mobile-sections-label" class="doc-sidebar__section-label">Contents</p>
          <ul class="doc-nav__list doc-nav__list--mobile" role="list">
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Introduction</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-introduction.html" class="doc-nav__link">Introduction</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Toolchain requirements</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-toolchain-requirements.html" class="doc-nav__link">Toolchain requirements</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">The three amigos</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-the-three-amigos.html" class="doc-nav__link">The three amigos</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Gherkin feature files</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-gherkin-feature-files.html" class="doc-nav__link">Gherkin feature files</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-gherkin-feature-files.html#gherkin-feature-files-example-feature-file" class="doc-nav__link">Example feature file</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-gherkin-feature-files.html#gherkin-feature-files-internationalised-scenarios" class="doc-nav__link">Internationalised scenarios</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Step definitions</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-step-definitions.html" class="doc-nav__link">Step definitions</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-step-definitions.html#step-definitions-fixtures-and-implicit-injection" class="doc-nav__link">Fixtures and implicit injection</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-step-definitions.html#step-definitions-step-return-values" class="doc-nav__link">Step return values</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-step-definitions.html#step-definitions-struct-based-step-arguments" class="doc-nav__link">Struct-based step arguments</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-step-definitions.html#step-definitions-scenario-state-slots" class="doc-nav__link">Scenario state slots</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-step-definitions.html#step-definitions-implicit-fixture-injection" class="doc-nav__link">Implicit fixture injection</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-step-definitions.html#step-definitions-inferred-step-patterns" class="doc-nav__link">Inferred step patterns</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Binding tests to scenarios</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-binding-tests-to-scenarios.html" class="doc-nav__link">Binding tests to scenarios</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-binding-tests-to-scenarios.html#binding-tests-to-scenarios-skipping-scenarios" class="doc-nav__link">Skipping scenarios</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Autodiscovering scenarios</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-autodiscovering-scenarios.html" class="doc-nav__link">Autodiscovering scenarios</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Running and maintaining tests</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-running-and-maintaining-tests.html" class="doc-nav__link">Running and maintaining tests</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Data tables and Docstrings</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-data-tables-and-docstrings.html" class="doc-nav__link">Data tables and Docstrings</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-data-tables-and-docstrings.html#data-tables-and-docstrings-debugging-data-table-errors" class="doc-nav__link">Debugging data table errors</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Limitations and roadmap</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-limitations-and-roadmap.html" class="doc-nav__link">Limitations and roadmap</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Assertion macros</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-assertion-macros.html" class="doc-nav__link">Assertion macros</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Internationalization and localization</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-internationalization-and-localization.html" class="doc-nav__link">Internationalization and localization</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-internationalization-and-localization.html#internationalization-and-localization-writing-feature-files-in-other-languages" class="doc-nav__link">Writing feature files in other languages</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-internationalization-and-localization.html#internationalization-and-localization-localizing-runtime-diagnostics" class="doc-nav__link">Localizing runtime diagnostics</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Diagnostic tooling</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-diagnostic-tooling.html" class="doc-nav__link">Diagnostic tooling</a>
                    </li>
                    <li>
                      <a href="docs-rstest-bdd-diagnostic-tooling.html#diagnostic-tooling-scenario-report-writers" class="doc-nav__link">Scenario report writers</a>
                    </li>
                </ul>
              </li>
              <li class="doc-nav-group">
                <h3 class="doc-nav-group__title">Summary</h3>
                <ul class="doc-nav__list doc-nav__list--mobile" role="list">
                    <li>
                      <a href="docs-rstest-bdd-summary.html" class="doc-nav__link">Summary</a>
                    </li>
                </ul>
              </li>
          </ul>
        </nav>

        <header class="doc-hero" id="doc-title">
          <h1 class="doc-hero__title">Step definitions</h1>
          <div class="doc-meta-list">
              <span class="doc-meta-list__item">Version 0.1.0</span>
            <span class="doc-meta-list__item">Updated Nov 08, 2025</span>
          </div>
        </header>

        <article class="doc-article">
              <section class="doc-section">
                <div class="doc-prose"><p>Developers implement the behaviour described in a feature by writing step
definition functions in Rust. Each step definition is an ordinary function
annotated with one of the attribute macros <code>#[given]</code>, <code>#[when]</code> or <code>#[then]</code>.
The annotation takes a single string literal that must match the text of the
corresponding step in the feature file. Placeholders in the form <code>{name}</code> or
<code>{name:Type}</code> are supported. The framework extracts matching substrings and
converts them using <code>FromStr</code>; type hints constrain the match using specialized
regular expressions. If the step text does not supply a capture for a declared
argument, the wrapper panics with
<code>pattern '&lt;pattern&gt;' missing capture for argument '&lt;name&gt;'</code>, making the
mismatch explicit.</p>
<p>The procedural macro implementation expands the annotated function into two
parts: the original function and a wrapper function that registers the step in
a global registry. The wrapper captures the step keyword, pattern string and
associated fixtures and uses the <code>inventory</code> crate to publish them for later
lookup.</p></div>
              </section>
                <section id="step-definitions-fixtures-and-implicit-injection" class="doc-section">
                  <div class="doc-section__heading">
                    <h2>Fixtures and implicit injection</h2>
                  </div>
                  <div class="doc-prose"><p><code>rstest‑bdd</code> builds on <code>rstest</code>’s fixture system rather than using a monolithic
“world” object. Fixtures are defined using <code>#[rstest::fixture]</code> in the usual
way. When a step function parameter does not correspond to a placeholder in the
step pattern, the macros treat it as a fixture and inject the value
automatically. The optional <code>#[from(name)]</code> attribute remains available when a
parameter name must differ from the fixture. Importing a symbol of the same
name is not required; do not alias a function or item just to satisfy the
compiler. Only the key stored in <code>StepContext</code> must match.</p>
<p>Internally, the step macros record the fixture names and generate wrapper code
that, at runtime, retrieves references from a <code>StepContext</code>. This context is a
key–value map of fixture names to type‑erased references. When a scenario runs,
the generated test inserts its arguments (the <code>rstest</code> fixtures) into the
<code>StepContext</code> before invoking each registered step.</p></div>
                </section>
                <section id="step-definitions-step-return-values" class="doc-section">
                  <div class="doc-section__heading">
                    <h2>Step return values</h2>
                  </div>
                  <div class="doc-prose"><p><code>#[when]</code> steps may return a value. The scenario runner scans the available
fixtures for ones whose <code>TypeId</code> matches the returned value. When exactly one
fixture uses that type, the override is recorded under that fixture’s name and
subsequent steps receive the most recent value (last write wins). Ambiguous or
missing matches leave fixtures untouched, keeping scenarios predictable while
still allowing a functional style without mutable fixtures.</p>
<p>Steps may also return <code>Result&lt;T, E&gt;</code>. An <code>Err</code> aborts the scenario, while an
<code>Ok</code> value is injected as above. Type aliases to <code>Result</code> behave identically.
Returning <code>()</code> or <code>Ok(())</code> produces no stored value, so fixtures of <code>()</code> are
not overwritten.</p>
<div class="codehilite" data-language="rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">rstest</span><span class="p">::</span><span class="n">fixture</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">rstest_bdd_macros</span><span class="p">::{</span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">when</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="p">,</span><span class="w"> </span><span class="n">scenario</span><span class="p">};</span>

<span class="cp">#[fixture]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">number</span><span class="p">()</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">i32</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>

<span class="cp">#[when(</span><span class="s">&quot;it is incremented&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">increment</span><span class="p">(</span><span class="n">number</span><span class="p">:</span><span class="w"> </span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">i32</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>

<span class="cp">#[then(</span><span class="s">&quot;the result is 2&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="n">number</span><span class="p">:</span><span class="w"> </span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>

<span class="cp">#[scenario(path = </span><span class="s">&quot;tests/features/step_return.feature&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">returns_value</span><span class="p">(</span><span class="n">number</span><span class="p">:</span><span class="w"> </span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div></div>
                </section>
                <section id="step-definitions-struct-based-step-arguments" class="doc-section">
                  <div class="doc-section__heading">
                    <h2>Struct-based step arguments</h2>
                  </div>
                  <div class="doc-prose"><p>When a step pattern contains several placeholders, the corresponding function
signatures quickly become unwieldy. Derive the <code>StepArgs</code> trait for a struct
whose fields mirror the placeholders and annotate the relevant parameter with
<code>#[step_args]</code> to request struct-based parsing. The attribute tells the macro
to consume every placeholder for that parameter, while fixtures and other
special arguments (<code>datatable</code>/<code>docstring</code>) continue to work as usual.</p>
<p>Fields must implement <code>FromStr</code>, and the derive macro enforces the bounds
automatically. Placeholders and struct fields must appear in the same order.
During expansion the macro inserts a compile-time check to ensure the field
count matches the pattern, producing a trait-bound error if the struct does not
implement <code>StepArgs</code>.</p>
<div class="codehilite" data-language="rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">rstest</span><span class="p">::</span><span class="n">fixture</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">rstest_bdd_macros</span><span class="p">::{</span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">scenario</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="p">,</span><span class="w"> </span><span class="n">when</span><span class="p">,</span><span class="w"> </span><span class="n">StepArgs</span><span class="p">};</span>

<span class="cp">#[derive(StepArgs)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">CartInput</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">quantity</span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="p">,</span>
<span class="w">    </span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">price</span><span class="p">:</span><span class="w"> </span><span class="kt">f32</span><span class="p">,</span>
<span class="p">}</span>

<span class="cp">#[derive(Default)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">Cart</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">quantity</span><span class="p">:</span><span class="w"> </span><span class="kt">u32</span><span class="p">,</span>
<span class="w">    </span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">price</span><span class="p">:</span><span class="w"> </span><span class="kt">f32</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">impl</span><span class="w"> </span><span class="n">Cart</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">details</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">CartInput</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">quantity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="n">quantity</span><span class="p">;</span>
<span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="n">item</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
<span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="n">price</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="cp">#[fixture]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">cart</span><span class="p">()</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Cart</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Cart</span><span class="p">::</span><span class="n">default</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>

<span class="cp">#[given(</span><span class="s">&quot;a cart containing {quantity:u32} {item} at ${price:f32}&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">seed_cart</span><span class="p">(</span><span class="cp">#[step_args]</span><span class="w"> </span><span class="n">details</span><span class="p">:</span><span class="w"> </span><span class="nc">CartInput</span><span class="p">,</span><span class="w"> </span><span class="n">cart</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Cart</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cart</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">details</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#[then(</span><span class="s">&quot;the cart summary shows {quantity:u32} {item} at ${price:f32}&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">cart_summary</span><span class="p">(</span><span class="cp">#[step_args]</span><span class="w"> </span><span class="n">expected</span><span class="p">:</span><span class="w"> </span><span class="nc">CartInput</span><span class="p">,</span><span class="w"> </span><span class="n">cart</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Cart</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">cart</span><span class="p">.</span><span class="n">quantity</span><span class="p">,</span><span class="w"> </span><span class="n">expected</span><span class="p">.</span><span class="n">quantity</span><span class="p">);</span>
<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">cart</span><span class="p">.</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">expected</span><span class="p">.</span><span class="n">item</span><span class="p">);</span>
<span class="w">    </span><span class="fm">assert!</span><span class="p">((</span><span class="n">cart</span><span class="p">.</span><span class="n">price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">expected</span><span class="p">.</span><span class="n">price</span><span class="p">).</span><span class="n">abs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="kt">f32</span><span class="p">::</span><span class="n">EPSILON</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><code>#[step_args]</code> must not be combined with <code>#[from]</code> and cannot target reference
types because the macro needs to own the struct to parse it. Attempting to use
multiple <code>#[step_args]</code> parameters in a single step yields a compile-time
error. The compiler also surfaces an error when the step pattern does not
declare any placeholders.</p>
<p>Example:</p>
<div class="codehilite" data-language="rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">rstest</span><span class="p">::</span><span class="n">fixture</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">rstest_bdd_macros</span><span class="p">::{</span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">when</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="p">,</span><span class="w"> </span><span class="n">scenario</span><span class="p">};</span>

<span class="c1">// A fixture used by multiple steps.</span>
<span class="cp">#[fixture]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">basket</span><span class="p">()</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Basket</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Basket</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="p">}</span>

<span class="cp">#[given(</span><span class="s">&quot;an empty basket&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">empty_basket</span><span class="p">(</span><span class="n">basket</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Basket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">basket</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="p">}</span>

<span class="cp">#[when(</span><span class="s">&quot;the user adds a pumpkin&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">add_pumpkin</span><span class="p">(</span><span class="n">basket</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Basket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">basket</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Item</span><span class="p">::</span><span class="n">Pumpkin</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#[then(</span><span class="s">&quot;the basket contains one pumpkin&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">assert_pumpkins</span><span class="p">(</span><span class="n">basket</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Basket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">basket</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">Item</span><span class="p">::</span><span class="n">Pumpkin</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#[scenario(path = </span><span class="s">&quot;tests/features/shopping.feature&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">test_add_to_basket</span><span class="p">(</span><span class="cp">#[with(basket)]</span><span class="w"> </span><span class="n">_</span><span class="p">:</span><span class="w"> </span><span class="nc">Basket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// optional assertions after the steps</span>
<span class="p">}</span>
</code></pre></div></div>
                </section>
                <section id="step-definitions-scenario-state-slots" class="doc-section">
                  <div class="doc-section__heading">
                    <h2>Scenario state slots</h2>
                  </div>
                  <div class="doc-prose"><p>Complex scenarios often need to capture intermediate results or share mutable
state between multiple steps. Historically, this required wrapping every field
in <code>RefCell&lt;Option&lt;T&gt;&gt;</code>, introducing noise and risking forgotten resets. The
<code>rstest-bdd</code> runtime now provides <code>Slot&lt;T&gt;</code>, a thin wrapper that exposes a
focused API for populating, reading, and clearing per-scenario values. Each
slot starts empty and supports helpers such as <code>set</code>, <code>replace</code>,
<code>get_or_insert_with</code>, <code>take</code>, and predicates <code>is_empty</code>/<code>is_filled</code>.</p>
<p>Define a state struct whose fields are <code>Slot&lt;T&gt;</code> and derive [<code>ScenarioState</code>].
The derive macro clears every slot by implementing <code>ScenarioState::reset</code> and
it automatically adds a [<code>Default</code>] implementation that leaves all slots empty.
<strong>Do not</strong> also derive or implement <code>Default</code>: Rust will report a
duplicate-implementation error because the macro already provides it. When you
need custom initialization, plan to use the future
<code>#[scenario_state(no_default)]</code> flag (or equivalent) to opt out of the
generated <code>Default</code> and supply your own logic.</p>
<div class="codehilite" data-language="rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">rstest</span><span class="p">::</span><span class="n">fixture</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">rstest_bdd</span><span class="p">::{</span><span class="n">ScenarioState</span><span class="p">,</span><span class="w"> </span><span class="n">Slot</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">rstest_bdd_macros</span><span class="p">::{</span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">scenario</span><span class="p">,</span><span class="w"> </span><span class="n">then</span><span class="p">,</span><span class="w"> </span><span class="n">when</span><span class="p">,</span><span class="w"> </span><span class="n">ScenarioState</span><span class="p">};</span>

<span class="cp">#[derive(ScenarioState)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">CliState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">output</span><span class="p">:</span><span class="w"> </span><span class="nc">Slot</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="n">exit_code</span><span class="p">:</span><span class="w"> </span><span class="nc">Slot</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="cp">#[fixture]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">cli_state</span><span class="p">()</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">CliState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">CliState</span><span class="p">::</span><span class="n">default</span><span class="p">()</span>
<span class="p">}</span>

<span class="cp">#[when(</span><span class="s">&quot;I run the CLI with {word}&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">run_command</span><span class="p">(</span><span class="n">cli_state</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">CliState</span><span class="p">,</span><span class="w"> </span><span class="n">argument</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">format!</span><span class="p">(</span><span class="s">&quot;ran {argument}&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">cli_state</span><span class="p">.</span><span class="n">output</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
<span class="w">    </span><span class="n">cli_state</span><span class="p">.</span><span class="n">exit_code</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#[then(</span><span class="s">&quot;the CLI succeeded&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">cli_succeeded</span><span class="p">(</span><span class="n">cli_state</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">CliState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">cli_state</span><span class="p">.</span><span class="n">exit_code</span><span class="p">.</span><span class="n">get</span><span class="p">(),</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="p">}</span>

<span class="cp">#[then(</span><span class="s">&quot;I can reset the state&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">reset_state</span><span class="p">(</span><span class="n">cli_state</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">CliState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cli_state</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
<span class="w">    </span><span class="fm">assert!</span><span class="p">(</span><span class="n">cli_state</span><span class="p">.</span><span class="n">output</span><span class="p">.</span><span class="n">is_empty</span><span class="p">());</span>
<span class="p">}</span>

<span class="cp">#[scenario(path = </span><span class="s">&quot;tests/features/cli.feature&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">cli_behaviour</span><span class="p">(</span><span class="n">cli_state</span><span class="p">:</span><span class="w"> </span><span class="nc">CliState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cli_state</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>Slots are independent, so scenarios can freely mix eager <code>set</code> calls with lazy
<code>get_or_insert_with</code> initializers. Because slots live inside a regular fixture,
the state benefits from <code>rstest</code>’s usual lifecycle: a fresh struct is produced
for each scenario invocation, yet it remains trivial to clear and reuse the
contents when chaining multiple behaviours inside a single test body.</p></div>
                </section>
                <section id="step-definitions-implicit-fixture-injection" class="doc-section">
                  <div class="doc-section__heading">
                    <h2>Implicit fixture injection</h2>
                  </div>
                  <div class="doc-prose"><p>Implicit fixtures such as <code>basket</code> must already be in scope in the test module;
<code>#[from(name)]</code> only renames a fixture and does not create one.</p>
<p>In this example, the step texts in the annotations must match the feature file
verbatim. The <code>#[scenario]</code> macro binds the test function to the first scenario
in the specified feature file and runs all registered steps before executing
the body of <code>test_add_to_basket</code>.</p></div>
                </section>
                <section id="step-definitions-inferred-step-patterns" class="doc-section">
                  <div class="doc-section__heading">
                    <h2>Inferred step patterns</h2>
                  </div>
                  <div class="doc-prose"><p>Step macros may omit the pattern string or provide a string literal containing
only whitespace. In either case, the macro derives a pattern from the function
name by replacing underscores with spaces.</p>
<div class="codehilite" data-language="rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">rstest_bdd_macros</span><span class="p">::</span><span class="n">given</span><span class="p">;</span>

<span class="cp">#[given]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">user_logs_in</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// pattern &quot;user logs in&quot; is inferred</span>
<span class="p">}</span>
</code></pre></div>

<p>This reduces duplication between function names and patterns. A literal <code>""</code>
registers an empty pattern instead of inferring one.</p>
<blockquote>
<p>Note
Inference preserves spaces derived from underscores:</p>
<ul>
<li>Leading and trailing underscores become leading or trailing spaces.</li>
<li>Consecutive underscores become multiple spaces.</li>
<li>Letter case is preserved.</li>
</ul>
</blockquote></div>
                </section>
        </article>
      </section>
    </div>
  </main>

  <footer id="footer" class="site-footer">
    <div class="site-footer__grid site-footer__grid--docs">
      <div>
        <p class="site-footer__brand">df12 Productions</p>
        <p class="site-footer__text">Serious systems, playful worlds. We ship tools that cut build times and stories that map the human edge of complex networks.</p>
      </div>
      <div>
        <h3>OSS &amp; Licences</h3>
        <ul class="site-footer__list">
          <li><a class="footer-link" href="https://github.com/leynos/limela/blob/main/LICENSE" target="_blank" rel="noopener noreferrer">Limela — licence</a></li>
          <li><a class="footer-link" href="https://github.com/leynos/netsuke/blob/main/LICENSE" target="_blank" rel="noopener noreferrer">Netsuke — licence</a></li>
          <li><a class="footer-link" href="https://github.com/leynos/mxd/blob/main/LICENSE" target="_blank" rel="noopener noreferrer">mxd — licence</a></li>
          <li><a class="footer-link" href="https://github.com/leynos/episodic/blob/main/LICENSE" target="_blank" rel="noopener noreferrer">Episodic — licence</a></li>
        </ul>
      </div>
      <div>
        <h3>Stay in touch</h3>
        <ul class="site-footer__list">
          <li><a class="footer-link" data-variant="accent" href="mailto:hello@df12.studio">hello@df12.studio</a></li>
          <li>
            <a class="footer-link" data-variant="accent" href="https://github.com/leynos" target="_blank" rel="noopener noreferrer">
              <iconify-icon icon="carbon:logo-github" class="h-4 w-4" aria-hidden="true"></iconify-icon>
              GitHub
            </a>
          </li>
          <li>
            <a class="footer-link" data-variant="accent" href="https://bsky.app/profile/df12.studio" target="_blank" rel="noopener noreferrer">
              <iconify-icon icon="carbon:logo-bluesky" class="h-4 w-4" aria-hidden="true"></iconify-icon>
              Bluesky
            </a>
          </li>
        </ul>
        <p class="site-footer__closing">Built for curious builders and storytellers everywhere. ©&nbsp;2025&nbsp;df12&nbsp;Productions.</p>
      </div>
    </div>
  </footer>

  <script>
    (() => {
      const blocks = document.querySelectorAll('.codehilite');
      if (!blocks.length) {
        return;
      }

      const formatLanguage = (raw) => {
        const value = (raw || '').trim();
        if (!value || value.toLowerCase() === 'text') {
          return 'Plain Text';
        }
        return value
          .replace(/[._-]+/g, ' ')
          .replace(/\b\w/g, (char) => char.toUpperCase());
      };

      const writeClipboard = async (text) => {
        if (!text) {
          return false;
        }
        try {
          if (navigator.clipboard?.writeText) {
            await navigator.clipboard.writeText(text);
            return true;
          }
        } catch (error) {
          /* fall back */
        }

        try {
          const textarea = document.createElement('textarea');
          textarea.value = text;
          textarea.setAttribute('readonly', 'readonly');
          textarea.style.position = 'absolute';
          textarea.style.left = '-9999px';
          document.body.appendChild(textarea);
          textarea.select();
          const success = document.execCommand('copy');
          document.body.removeChild(textarea);
          return success;
        } catch (error) {
          return false;
        }
      };

      blocks.forEach((block) => {
        if (block.dataset.enhanced === 'true') {
          return;
        }
        const pre = block.querySelector('pre');
        const code = block.querySelector('code') || pre;
        if (!pre || !code) {
          return;
        }

        block.dataset.enhanced = 'true';

        const chrome = document.createElement('div');
        chrome.className = 'codehilite__chrome';

        const languageLabel = document.createElement('span');
        languageLabel.className = 'codehilite__language';
        const lang = block.dataset.language || '';
        const readableLang = formatLanguage(lang);
        languageLabel.textContent = readableLang;

        const copyButton = document.createElement('button');
        copyButton.type = 'button';
        copyButton.className = 'codehilite__copy';
        copyButton.setAttribute('aria-label', `Copy ${readableLang} code snippet`);
        copyButton.innerHTML = `
          <span class="codehilite__copy-icon" aria-hidden="true">
            <iconify-icon icon="carbon:copy" class="h-4 w-4"></iconify-icon>
          </span>
          <span class="codehilite__copy-text">Copy</span>
        `;

        chrome.appendChild(languageLabel);
        chrome.appendChild(copyButton);
        block.insertBefore(chrome, pre);

        const copyTextLabel = copyButton.querySelector('.codehilite__copy-text');
        let resetTimer;

        copyButton.addEventListener('click', async () => {
          const textContent = code.textContent || '';
          const didCopy = await writeClipboard(textContent.trimEnd());
          if (!didCopy) {
            let selectionApplied = false;
            if (window.getSelection && document.createRange) {
              const selection = window.getSelection();
              if (selection) {
                try {
                  const range = document.createRange();
                  range.selectNodeContents(code);
                  selection.removeAllRanges();
                  selection.addRange(range);
                  selectionApplied = true;
                  const focusTarget = block.querySelector('pre');
                  if (focusTarget) {
                    if (focusTarget.tabIndex < 0) {
                      focusTarget.tabIndex = -1;
                    }
                    focusTarget.focus({ preventScroll: true });
                  }
                } catch (err) {
                  selectionApplied = false;
                }
              }
            }
            if (copyTextLabel) {
              copyTextLabel.textContent = selectionApplied
                ? 'Press ⌘/Ctrl+C'
                : 'Select the code and press ⌘/Ctrl+C';
            }
            clearTimeout(resetTimer);
            resetTimer = setTimeout(() => {
              copyButton.removeAttribute('data-state');
              if (copyTextLabel) {
                copyTextLabel.textContent = 'Copy';
              }
            }, 2500);
            return;
          }
          copyButton.dataset.state = 'copied';
          if (copyTextLabel) {
            copyTextLabel.textContent = 'Copied';
          }
          clearTimeout(resetTimer);
          resetTimer = setTimeout(() => {
            copyButton.removeAttribute('data-state');
            if (copyTextLabel) {
              copyTextLabel.textContent = 'Copy';
            }
          }, 2500);
        });
      });
    })();
  </script>
<script
  src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"
  defer
  integrity="sha384-GPb5RlngihS9H0z1D137JsvzmeZ7tCpWEF4t5YDoTZyMsPP8S7h7vFDh4XhheU83"
  crossorigin="anonymous"
></script>
</body>
</html>